library(readr)
model <- read_csv("E:/ZikNet/pythonScripts/model.csv")
pairs(model)
pairs(~Casos+Busquedas+Precipitacion+Temp+Altura, data=model)
View(model)
View(model)
fit <- lm(Casos ~ Busquedas+Precipitacion+Temp, data=model)
inTrain <- createDataPartition(y=model$Casos, p=0.7, list=FALSE)
trainingSet <- model[inTrain,]
testingSet <- model[-inTrain,]
dim(trainingSet);dim(testingSet)
library(ISLR); library(ggplot2); library(caret)
pairs(~Casos+Busquedas+Precipitacion+Temp+Altura, data=model)
fit <- lm(Casos ~ Busquedas+Precipitacion+Temp, data=model)
inTrain <- createDataPartition(y=model$Casos, p=0.7, list=FALSE)
trainingSet <- model[inTrain,]
testingSet <- model[-inTrain,]
dim(trainingSet);dim(testingSet)
TrainingModel <- lm(Casos ~ Busquedas+Precipitacion+Temp, data=trainingSet)
summary(TrainingModel)
predict(TrainingModel, testingSet, interval="predict")
CheckModel <- train(Casos ~ Busquedas+Precipitacion+Temp, data=trainingSet, method="lm")
DoubleCheckModel<-CheckModel$finalModel
plot(DoubleCheckModel,1,pch=19,cex=0.5)
TestingModel<-lm(Casos ~ Busquedas+Precipitacion+Temp, data=testingSet)
sqrt(sum((TrainingModel$fitted-trainingSet$Casos)^2))
sqrt(sum((TestingModel$fitted-testingSet$Casos)^2))
lin.reg <- lm(log(Casos+1) ~ Busquedas + Precipitacion + Temp + Altura data=trainingSet)
summary(lin.reg)
library(ISLR); library(ggplot2); library(caret)
pairs(~Casos+Busquedas+Precipitacion+Temp+Altura, data=model)
fit <- lm(Casos ~ Busquedas+Precipitacion+Temp, data=model)
inTrain <- createDataPartition(y=model$Casos, p=0.7, list=FALSE)
trainingSet <- model[inTrain,]
testingSet <- model[-inTrain,]
dim(trainingSet);dim(testingSet)
lin.reg <- lm(log(Casos+1) ~ Busquedas + Precipitacion + Temp + Altura data=trainingSet)
summary(lin.reg)
lin.reg <- lm(log(Casos+1) ~ Busquedas + Precipitacion + Temp + Altura, data=trainingSet)
summary(lin.reg)
test.pred.pin <- exp(predict(lin.reg,testingSet))-1
RMSE.lin.reg <- sqrt(mean((test.pred.lin-testingSet$Casos)^2))
RMSE.lin.reg
RMSE.lin.reg <- sqrt(mean((test.pred.lin-testingSet$Casos)^2))
test.pred.pin <- exp(predict(lin.reg,testingSet))-1
RMSE.lin.reg <- sqrt(mean((test.pred.lin-testingSet$Casos)^2))
rm(test.pred.pin)
test.pred.lin <- exp(predict(lin.reg,testingSet))-1
RMSE.lin.reg <- sqrt(mean((test.pred.lin-testingSet$Casos)^2))
RMSE.lin.reg
MAE.lin.reg <- mean(abs(test.pred.lin-testingSet$Casos))
MAE.lin.reg
lin.reg <- lm(log(Casos+1) ~ Busquedas + Precipitacion + Temp, data = trainingSet)
summary(lin.reg)
test.pred.lin <- exp(predict(lin.reg,testingSet))-1
#Error cuadrÃ¡tico
RMSE.lin.reg <- sqrt(mean((test.pred.lin-testingSet$Casos)^2))
RMSE.lin.reg
MAE.lin.reg <- mean(abs(test.pred.lin-testingSet$Casos))
MAE.lin.reg
library(rpart)
library(rpart)
library(raddle)
install.packages("rattle")
library(rpart)
library(rattle)
library(rpart)
library(raddle)
library(rpart)
library("rattle")
install.packages("rattle")
library(rpart)
library("rattle")
library(rpart)
library(rattle)
install.packages("rattle")
library(rpart)
library(rattle)
library(readr)
library(ggplot2)
#veracruz <- read_csv("E:/ZikNet/pythonScripts/veracruzModel.csv")
#veracruz <- VeracruzWeatherDataCopy
View(veracruz)
####################
#                  #
#    Exercise 1    #
#                  #
####################
require(ggplot2)
require(gridExtra)
#df <- read_csv("E:/ZikNet/pythonScripts/veracruzModel.csv")
df <- veracruz
p1 <- ggplot(df, aes(x = X, y = Busquedas)) +
ylab("Busquedas") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p2 <- ggplot(df, aes(x = X, y = Precipitacion)) +
ylab("Precipitacion") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p3 <- ggplot(df, aes(x = X, y = precipProbability)) +
ylab("precipProbability") +
xlab("Period") +
geom_line() +
expand_limits(x = 0, y = 0)
grid.arrange(p1, p2, p3, ncol=1, nrow=3)
library(readr)
library(ggplot2)
#veracruz <- read_csv("E:/ZikNet/pythonScripts/veracruzModel.csv")
#veracruz <- VeracruzWeatherDataCopy
View(veracruz)
library(readr)
library(ggplot2)
veracruz <- read_csv("E:/ZikNet/pythonScripts/veracruzModel.csv")
#veracruz <- VeracruzWeatherDataCopy
View(veracruz)
require(ggplot2)
require(gridExtra)
#df <- read_csv("E:/ZikNet/pythonScripts/veracruzModel.csv")
df <- veracruz
p1 <- ggplot(df, aes(x = X, y = Busquedas)) +
ylab("Busquedas") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p2 <- ggplot(df, aes(x = X, y = Precipitacion)) +
ylab("Precipitacion") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p3 <- ggplot(df, aes(x = X, y = precipProbability)) +
ylab("precipProbability") +
xlab("Period") +
geom_line() +
expand_limits(x = 0, y = 0)
grid.arrange(p1, p2, p3, ncol=1, nrow=3)
df <- veracruz
p1 <- ggplot(df, aes(x = X, y = Busquedas)) +
ylab("Busquedas") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p2 <- ggplot(df, aes(x = X, y = Precipitacion)) +
ylab("Precipitacion") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p3 <- ggplot(df, aes(x = X, y = precipProbability)) +
ylab("precipProbability") +
xlab("Period") +
geom_line() +
expand_limits(x = 0, y = 0)
grid.arrange(p1, p2, p3, ncol=1, nrow=3)
grid.arrange(p1, p2, p3, ncol=1, nrow=2)
grid.arrange(p1, p2, p3, ncol=1, nrow=4)
grid.arrange(p1, p2, p3, ncol=3, nrow=3)
grid.arrange(p1, p2, p3, ncol=3, nrow=1)
grid.arrange(p1, p2, p3)
p1
p2
p3
#df <- read_csv("E:/ZikNet/pythonScripts/veracruzModel.csv")
df <- veracruz
X <- veracruz$Casos
p1 <- ggplot(df, aes(x = X, y = Busquedas)) +
ylab("Busquedas") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p2 <- ggplot(df, aes(x = X, y = Precipitacion)) +
ylab("Precipitacion") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p3 <- ggplot(df, aes(x = X, y = precipProbability)) +
ylab("precipProbability") +
xlab("Period") +
geom_line() +
expand_limits(x = 0, y = 0)
grid.arrange(p1, p2, p3)
df <- veracruz
X <- veracruz$Casos
p1 <- ggplot(df, aes(x = X, y = Busquedas)) +
ylab("Busquedas") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p2 <- ggplot(df, aes(x = X, y = Precipitacion)) +
ylab("Precipitacion") +
xlab("") +
geom_line() +
expand_limits(x = 0, y = 0)
p3 <- ggplot(df, aes(x = X, y = Temp)) +
ylab("precipProbability") +
xlab("Period") +
geom_line() +
expand_limits(x = 0, y = 0)
grid.arrange(p1, p2, p3)
require(forecast)
autoplot(fcast_cons)
require(forecast)
fit_cons <- auto.arima((df$Casos))
fcast_cons <- forecast(fit_cons, h = 2)
require(forecast)
autoplot(fcast_cons)
require(lmtest)
coeftest(fit_cons_busquedas)
require(forecast)
fit_cons_busquedas <- auto.arima(df$Casos, xreg = df$Busquedas)
require(lmtest)
coeftest(fit_cons_busquedas)
